@startuml
skinparam dpi 300

'''''''''''''''''''''''''''
' Preprocessor Statements '
'''''''''''''''''''''''''''

' Resource Directory
!$resource_dir = "resources"

' Start Screen
!$start = "start.png"

' Login Screen
!$login = "login.png"
!$login_failed = "login-failed-zoomed.png"

' Sign Up Screen
!$sign_up = "sign-up.png"

' Main Menu Screen
!$main_ui = "main-ui.png"

' QR Inventory Screen
!$qr_inventory = "qr_inventory.png"

' Search Screens
!$search = "search.png"
!$search_username = "search-username.png"
!$search_geolocation = "search-geolocation.png"

' Map
!$map = "map.png"

' Friend List
!$friends = "friends.png"

' Leaderboard
!$leaderboard = "leaderboard.png"
!$leaderboard_sort_by = "leaderboard-sort-by.png"
!$leaderboard_highest_unique = "leaderboard-highest-unique.png"
!$leaderboard_total_scanned = "leaderboard-total-scanned.png"
!$leaderboard_total_sum_of_scores = "leaderboard-total-sum-of-scores.png"

' Camera
!$camera = "camera.png"

' Viewing a Someone's
!$view_profile = "view-profile.png"

'''''''''''''''''
' Begin Diagram '
'''''''''''''''''
start

repeat :<img:$resource_dir/$start{scale=0.5}>;

' Login & Sign Up
switch ()
case (Login)
    :<img:$resource_dir/$login{scale=0.5}>;
    repeat :Upload QR code;
        backward:<img:$resource_dir/$login_failed{scale=0.5}>;
    repeat while (Verification) is (invalid)
    ->valid;
case (Sign Up)
    :<img:$resource_dir/$sign_up{scale=0.5}>;
case (Exit)
    end
endswitch

' Main Menu
:<img:$resource_dir/$main_ui{scale=0.5}>;

' Leave note because we cannot loop back here
note right
All following activites
may return here
end note

backward:Return to start screen;
repeat while (Logout?) is (yes)
->no;

' Branch to Every Menu Option
switch()

case (My QR Inventory)
    while ()
    :My QR Inventory;
    switch(Delete QR Code from Inventory?)
    case (yes)
        :QR Code Removed from Inventory;
    case (no)
        ' We need this node to link the entire switch back
        :;
    endswitch
    endwhile
    -[hidden]->
    detach

case (Search)
    :<img:$resource_dir/$search{scale=0.5}>;

    while ()
    switch()
    case (Search by username)
        repeat
        :<img:$resource_dir/$search_username{scale=0.5}>;
        note left
        App will search as
        user enters characters
        end note
        backward:<img:$resource_dir/$view_profile{scale=0.4}>;
        repeat while (View User Profile?) is (yes)

    case (Search by geolocation)
        :<img:$resource_dir/$search_geolocation{scale=0.5}>;

    endswitch
    endwhile
    -[hidden]->
    detach

case (Map)
    :Map;
    while()
        switch()
        case (Add as Friend)
            switch()
            case (Player Selected)
                :Successfully added;
            case (No Player Selected)
                :A player needs to be selected;
            endswitch

        case (Select Player from Map)
            :Highlight Selected Player;

        endswitch
    endwhile
    -[hidden]->
    detach

case (Friends)
    while ()
        :Friends;
        :Open Friend Profile;
        :User Profile;
    endwhile
    -[hidden]->
    detach

case (Check Rank)
    :<img:$resource_dir/$leaderboard{scale=0.5}>;
    while ()
        :<img:$resource_dir/$leaderboard_sort_by{scale=0.5}>;
        switch()
        case (Sort by High Scores)
            :<img:$resource_dir/$leaderboard{scale=0.5}>;
        case (Sort by Highest Unique)
            :<img:$resource_dir/$leaderboard_highest_unique{scale=0.5}>;
        case (Sort by Total Scanned)
            :<img:$resource_dir/$leaderboard_total_scanned{scale=0.5}>;
        case (Sort by Total Sum of Scores)
            :<img:$resource_dir/$leaderboard_total_sum_of_scores{scale=0.5}>;
        endswitch
    endwhile
    -[hidden]->
    detach

case (Scan New QR)
    :Open Camera;

    switch(User Scanned QR Code?)
    case (yes)
        :Show Scan Results;
        note left
        User can toggle saving
        geolocation data and the
        QR code
        end note
        
        switch(Save Image?)
        case (Save)
            :QR Inventory;
            note right
            See QR Inventory Diagram
            for more detail
            end note
            stop

        case (Back)
            :Activity Quits to Main Menu;
            stop
        endswitch

    case (no)
        :Activity Quits to Main Menu;
        stop
    endswitch
endswitch

@enduml
